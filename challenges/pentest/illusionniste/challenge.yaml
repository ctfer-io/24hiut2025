apiVersion: v1alpha1
kind: ctfer.io/DynamicIaC
spec:
  name: L'illusionniste 
  description: |
    Un magicien ne révèle jamais ses secrets, mais parfois les scripts révèlent plus qu'ils ne devraient.
    Quelque chose vous attend sur cette machine, caché derrière des couches d'automatisation.

    Les outils sont souvent plus puissants qu'ils n'y paraissent, et certains langages 
    peuvent faire bien plus que leur fonction première...

    Format du flag : `24HIUT{...}`
  attribution: Fr4gments
  value: 500
  decay: 26
  minimum: 100
  function: logarithmic
  state: visible

  tags:
    - Hard
    - Système

  mana_cost: 1
  timeout: 3600
  scenario:
    apiVersion: v1alpha1
    kind: sdk.ctfer.io/manual
    spec:
      directory: infra/scenario
    additional:
      # Keep connection info in additional (will be easier to migrate to a recipe later)
      connectionInfo: |
        {{- $hostport := index .Ports "22/TCP" -}}
        {{- $parts := splitList ":" $hostport -}}
        {{- $host := index $parts 0 -}}
        {{- $port := "" -}}
        {{- if gt (len $parts) 1 -}}
          {{- $port = index $parts 1 -}}
        {{- end -}}
        ssh -p {{ $port }} {{ $host }} user:password
